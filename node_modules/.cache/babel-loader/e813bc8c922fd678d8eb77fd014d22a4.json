{"ast":null,"code":"import _slicedToArray from\"C:/Users/S.K. COMPUTER/OneDrive/Desktop/react-project/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React from\"react\";import{Col,Nav,NavItem,NavLink,Row,TabContent,TabPane}from\"reactstrap\";import classnames from\"classnames\";import NepaliDatePicker from\"components/React/Datepicker/Datepicker\";import EnglishDatePicker from\"components/React/EnglishDatepicker/EnglishDatepicker\";import StyledSelect from\"components/React/StyledSelect/StyledSelect\";import{GeneralCard}from\"components/UI/GeneralCard\";import{useTranslation}from\"react-i18next\";import{connect}from\"react-redux\";import{getWaterSupplyReportAction}from\"store/modules/report/waterSupply\";import{getSchemeYearIntervalsAction}from\"store/modules/waterScheme/getYearIntervals\";import{allTimeOptions,thisYearOptions,thisMonthOptions,thisWeekOptions}from\"./datas\";import VisualizationBarGraph from\"./VisualizationBarGraph\";import VisualizationBarGraphThisWeek from\"./VisualizationBarGraphThisWeek\";import VisualizationGraph from\"./VisualizationGraph\";import VisualizationGraphThisYear from\"./VisualizationGraphThisYear\";import formatDate,{getDefaultDate}from\"utils/utilsFunction/date-converter\";var SupplyVIsualization=function SupplyVIsualization(props){var _props$schemeDetails3;var _useTranslation=useTranslation([\"home\"]),t=_useTranslation.t;var _React$useState=React.useState([]),_React$useState2=_slicedToArray(_React$useState,2),yearOptions=_React$useState2[0],setYearOptions=_React$useState2[1];var _React$useState3=React.useState(\"\"),_React$useState4=_slicedToArray(_React$useState3,2),selectedYear=_React$useState4[0],setSelectedYear=_React$useState4[1];var _React$useState5=React.useState(\"1\"),_React$useState6=_slicedToArray(_React$useState5,2),activeTab=_React$useState6[0],setActiveTab=_React$useState6[1];var _React$useState7=React.useState(\"\"),_React$useState8=_slicedToArray(_React$useState7,2),activeDate=_React$useState8[0],setActiveDate=_React$useState8[1];var toggle=function toggle(tab){if(activeTab!==tab)setActiveTab(tab);};React.useEffect(function(){if(props.language&&props.schemeSlug){props.getSchemeYearIntervalsAction(props.language,props.schemeSlug);}},[props.language,props.schemeSlug]);React.useEffect(function(){if(props.intervalData){var intervalData=props.intervalData.map(function(item){return{value:item.id,label:\"\".concat(item.start_date,\" - \").concat(item.end_date)};});setYearOptions(intervalData);}},[props.intervalData]);React.useEffect(function(){if(props.schemeSlug&&props.schemeDetails){if(activeTab===\"1\"){props.getWaterSupplyReportAction(props.schemeSlug);}else if(activeTab===\"2\"){props.getWaterSupplyReportAction(props.schemeSlug,\"this_year=\".concat(selectedYear||1));}else if(activeTab===\"3\"){var _getDefaultDate,_props$schemeDetails,_getDefaultDate2,_props$schemeDetails2;props.getWaterSupplyReportAction(props.schemeSlug,\"year=\".concat((activeDate===null||activeDate===void 0?void 0:activeDate.split(\"-\")[0])||((_getDefaultDate=getDefaultDate((_props$schemeDetails=props.schemeDetails)===null||_props$schemeDetails===void 0?void 0:_props$schemeDetails.system_date_format))===null||_getDefaultDate===void 0?void 0:_getDefaultDate.split(\"-\")[0]),\"&this_month=\").concat((activeDate===null||activeDate===void 0?void 0:activeDate.split(\"-\")[1])||((_getDefaultDate2=getDefaultDate((_props$schemeDetails2=props.schemeDetails)===null||_props$schemeDetails2===void 0?void 0:_props$schemeDetails2.system_date_format))===null||_getDefaultDate2===void 0?void 0:_getDefaultDate2.split(\"-\")[1])));}else if(activeTab===\"4\"){props.getWaterSupplyReportAction(props.schemeSlug,\"this_week=true&date_from=\".concat(formatDate(activeDate||new Date()),\"&date_to=\").concat(formatDate(new Date(new Date(activeDate||new Date()).getTime()+7*24*60*60*1000))));}}},[props.language,activeTab,props.schemeSlug,selectedYear,activeDate,props.schemeDetails]);console.log(activeDate,\"asdasdasdasdasdasd\");return/*#__PURE__*/React.createElement(\"div\",{className:\"container py-3 cash-book customCase\"},/*#__PURE__*/React.createElement(GeneralCard,{title:t(\"sidebar:supplyVisualization\"),print:true},/*#__PURE__*/React.createElement(\"div\",{className:\"cash-content\"},/*#__PURE__*/React.createElement(\"div\",{className:\"flex-between\"},/*#__PURE__*/React.createElement(Nav,{tabs:true},/*#__PURE__*/React.createElement(NavItem,null,/*#__PURE__*/React.createElement(NavLink,{className:classnames({active:activeTab===\"1\"}),onClick:function onClick(){toggle(\"1\");}},t(\"home:allTime\"))),/*#__PURE__*/React.createElement(NavItem,null,/*#__PURE__*/React.createElement(NavLink,{className:classnames({active:activeTab===\"2\"}),onClick:function onClick(){toggle(\"2\");}},t(\"home:thisYear\"))),/*#__PURE__*/React.createElement(NavItem,null,/*#__PURE__*/React.createElement(NavLink,{className:classnames({active:activeTab===\"3\"}),onClick:function onClick(){toggle(\"3\");}},t(\"home:thisMonth\"))),/*#__PURE__*/React.createElement(NavItem,null,/*#__PURE__*/React.createElement(NavLink,{className:classnames({active:activeTab===\"4\"}),onClick:function onClick(){toggle(\"4\");}},t(\"home:thisWeek\"))),activeTab!==\"1\"&&/*#__PURE__*/React.createElement(NavItem,null,/*#__PURE__*/React.createElement(\"div\",{className:\"form-group my-0 py-0 pl-4\"},activeTab===\"2\"?/*#__PURE__*/React.createElement(\"div\",{className:\"flex-grow-1\",style:{width:200}},/*#__PURE__*/React.createElement(StyledSelect,{name:\"this_year\",options:yearOptions,value:yearOptions===null||yearOptions===void 0?void 0:yearOptions.find(function(item){return item.value===selectedYear;}),onChange:function onChange(e){var _e$value;setSelectedYear((_e$value=e.value)===null||_e$value===void 0?void 0:_e$value.value);}})):/*#__PURE__*/React.createElement(React.Fragment,null,((_props$schemeDetails3=props.schemeDetails)===null||_props$schemeDetails3===void 0?void 0:_props$schemeDetails3.system_date_format)===\"nep\"?/*#__PURE__*/React.createElement(NepaliDatePicker,{className:\"form-control\",name:\"name_en\",value:activeDate,onChange:function onChange(e){setActiveDate(e);}}):/*#__PURE__*/React.createElement(EnglishDatePicker,{name:\"eng\",value:activeDate||new Date(),handleChange:function handleChange(e){setActiveDate(formatDate(e));}}))))),/*#__PURE__*/React.createElement(\"span\",{className:\"info-text\"},t(\"home:allAmountInRupee\"),\" \",props.currency)),/*#__PURE__*/React.createElement(TabContent,{activeTab:activeTab,className:\"mt-2\"},/*#__PURE__*/React.createElement(TabPane,{tabId:\"1\"},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{sm:\"12\"},activeTab===\"1\"&&/*#__PURE__*/React.createElement(VisualizationGraph,{type:\"Year\",compareKey:\"date_from\",defaultSelected:[\"total_supply_avg\"],options:allTimeOptions,key:\"allTimeGraph\"})))),/*#__PURE__*/React.createElement(TabPane,{tabId:\"2\"},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{sm:\"12\"},activeTab===\"2\"&&/*#__PURE__*/React.createElement(VisualizationGraphThisYear,{type:\"Month\",defaultSelected:[\"total_supply_avg\"],options:thisYearOptions,selectedYear:selectedYear,key:\"yearGraph\"})),\" \")),/*#__PURE__*/React.createElement(TabPane,{tabId:\"3\"},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{sm:\"12\"},activeTab===\"3\"&&/*#__PURE__*/React.createElement(VisualizationBarGraph,{compareKey:\"supply_date\",defaultSelected:[\"total_supply\",\"daily_target\"],options:thisMonthOptions,key:\"thisMonthGraph\"})),\" \")),/*#__PURE__*/React.createElement(TabPane,{tabId:\"4\"},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{sm:\"12\"},activeTab===\"4\"&&/*#__PURE__*/React.createElement(VisualizationBarGraphThisWeek,{compareKey:\"supply_date\",defaultSelected:[\"total_supply_avg\"],options:thisWeekOptions,key:\"thisWeek\"})),\" \"))))));};var mapStateToProps=function mapStateToProps(state){var _state$waterSchemeDat,_state$waterSchemeDat2;return{language:state.i18nextData.languageType,schemeSlug:(_state$waterSchemeDat=state.waterSchemeData.waterSchemeDetailsData.data)===null||_state$waterSchemeDat===void 0?void 0:_state$waterSchemeDat.slug,schemeDetails:state.waterSchemeData.waterSchemeDetailsData.data,intervalData:state.waterSchemeData.getYearIntervals.data,currency:(_state$waterSchemeDat2=state.waterSchemeData.waterSchemeDetailsData.data)===null||_state$waterSchemeDat2===void 0?void 0:_state$waterSchemeDat2.currency};};var mapDispatchToProps={getWaterSupplyReportAction:getWaterSupplyReportAction,getSchemeYearIntervalsAction:getSchemeYearIntervalsAction};var connector=connect(mapStateToProps,mapDispatchToProps);export default connector(SupplyVIsualization);","map":null,"metadata":{},"sourceType":"module"}