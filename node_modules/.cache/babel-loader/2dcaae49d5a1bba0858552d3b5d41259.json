{"ast":null,"code":"import _asyncToGenerator from\"C:/Users/S.K. COMPUTER/OneDrive/Desktop/react-project/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _objectSpread from\"C:/Users/S.K. COMPUTER/OneDrive/Desktop/react-project/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/S.K. COMPUTER/OneDrive/Desktop/react-project/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\S.K. COMPUTER\\\\OneDrive\\\\Desktop\\\\react-project\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import NepaliDatePicker from\"components/React/Datepicker/Datepicker\";import EnglishDatePicker from\"components/React/EnglishDatepicker/EnglishDatepicker\";import FormikValidationError from\"components/React/FormikValidationError/FormikValidationError\";import toast from\"components/React/ToastNotifier/ToastNotifier\";import Button from\"components/UI/Forms/Buttons\";import TooltipLabel from\"components/UI/TooltipLabel\";import{useFormik}from\"formik\";import React from\"react\";import{useTranslation}from\"react-i18next\";import{connect}from\"react-redux\";import{getSchemeDataAction}from\"store/modules/waterScheme/getWaterSchemeData\";import{postWaterSchemeDataAction}from\"store/modules/waterScheme/postWaterSchemeData\";import{updateWaterSchemeDataAction}from\"store/modules/waterScheme/updateWaterSchemeData\";import formatDate from\"utils/utilsFunction/date-converter\";import{supplyBeltInitialValues,supplyBeltValidationSchema}from\"./schema\";var Form=function Form(props){var _props$scheme2;var _useTranslation=useTranslation([\"home\"]),t=_useTranslation.t;var _React$useState=React.useState(supplyBeltInitialValues),_React$useState2=_slicedToArray(_React$useState,2),initialData=_React$useState2[0],seetInitialData=_React$useState2[1];React.useEffect(function(){if(props.language&&props.schemeSlug){props.getSchemeDataAction(props.language);}},[props.language,props.schemeSlug]);React.useEffect(function(){if(props.editData){seetInitialData(_objectSpread({},props.editData));}},[props.editData]);React.useEffect(function(){if(props.scheme){var _props$scheme;seetInitialData(_objectSpread(_objectSpread({},props.editData),{},{apply_date:(_props$scheme=props.scheme)===null||_props$scheme===void 0?void 0:_props$scheme.tool_start_date}));}},[props.scheme]);var _useFormik=useFormik({enableReinitialize:true,initialValues:initialData,validationSchema:supplyBeltValidationSchema,onSubmit:function(){var _onSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(submitValue,_ref){var resetForm,requestData,res,_Object$values,_errors;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:resetForm=_ref.resetForm;requestData=_objectSpread({},submitValue);if(!props.editData){_context.next=8;break;}_context.next=5;return props.updateWaterSchemeDataAction(props.language,props.editData.id,requestData);case 5:res=_context.sent;_context.next=11;break;case 8:_context.next=10;return props.postWaterSchemeDataAction(props.language,requestData);case 10:res=_context.sent;case 11:console.log(res,\"resss\");if(res.status===201||res.status===200){if(res.status===201){resetForm();toast.success(t(\"home:postSuccess\"));}else{seetInitialData(supplyBeltInitialValues);toast.success(t(\"home:updateSuccess\"));}props.getSchemeDataAction(props.language);}else{_errors=(_Object$values=Object.values(res.data))===null||_Object$values===void 0?void 0:_Object$values.map(function(item){toast.error(item[0]);});}case 13:case\"end\":return _context.stop();}}},_callee);}));function onSubmit(_x,_x2){return _onSubmit.apply(this,arguments);}return onSubmit;}()}),values=_useFormik.values,errors=_useFormik.errors,touched=_useFormik.touched,handleChange=_useFormik.handleChange,setFieldValue=_useFormik.setFieldValue,handleSubmit=_useFormik.handleSubmit;return/*#__PURE__*/React.createElement(\"form\",{onSubmit:function onSubmit(e){e.preventDefault();handleSubmit(e);}},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group \"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-1 \"},t(\"home:instConn\"),\" \",\":\"),/*#__PURE__*/React.createElement(\"input\",{type:\"number\",className:\"form-control\",name:\"institutional_connection\",value:values.institutional_connection,onChange:handleChange}),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"institutional_connection\",errors:errors,touched:touched}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group \"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-1 \"},t(\"home:commercialConn\"),\" \",\":\"),/*#__PURE__*/React.createElement(\"input\",{type:\"number\",className:\"form-control\",name:\"commercial_connection\",value:values.commercial_connection,onChange:handleChange}),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"commercial_connection\",errors:errors,touched:touched}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group \"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-1 \"},t(\"home:houseConn\"),\" \"),/*#__PURE__*/React.createElement(\"input\",{type:\"number\",className:\"form-control\",name:\"household_connection\",value:values.household_connection,onChange:handleChange}),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"household_connection\",errors:errors,touched:touched}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group \"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-1 \"},t(\"home:publicConn\"),\":\"),/*#__PURE__*/React.createElement(\"input\",{type:\"number\",className:\"form-control\",name:\"public_connection\",value:values.public_connection,onChange:handleChange}),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"public_connection\",errors:errors,touched:touched}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group \"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-1 \"},t(\"home:applyDate\"),\" \",/*#__PURE__*/React.createElement(TooltipLabel,{id:\"tnohuws\",text:\"The date from which this record  should be applied to the system. \"}),\":\"),((_props$scheme2=props.scheme)===null||_props$scheme2===void 0?void 0:_props$scheme2.system_date_format)===\"nep\"?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(NepaliDatePicker,{value:values.apply_date,name:\"apply_date\",onChange:function onChange(e){setFieldValue(\"apply_date\",e);}})):/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(EnglishDatePicker,{name:\"apply_date\",value:values.apply_date,handleChange:function handleChange(e){setFieldValue(\"apply_date\",formatDate(e));}})),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"belt_type\",errors:errors,touched:touched}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-12 text-right\"},/*#__PURE__*/React.createElement(Button,{className:\"btn custom-btn  mr-3\",text:t(\"home:save\"),loading:props.postLoading||props.updateLoading,disabled:props.postLoading||props.updateLoading}),/*#__PURE__*/React.createElement(Button,{className:\"btn custom-btn-outlined mr-3\",text:t(\"home:cancel\"),type:\"button\",onClick:function onClick(){props.toggle();}}))));};var mapStateToProps=function mapStateToProps(state){var _state$waterSchemeDat;return{language:state.i18nextData.languageType,schemeSlug:(_state$waterSchemeDat=state.waterSchemeData.waterSchemeDetailsData.data)===null||_state$waterSchemeDat===void 0?void 0:_state$waterSchemeDat.slug,scheme:state.waterSchemeData.waterSchemeDetailsData.data,supplySchedule:state.waterSupplyData.waterScheduleData.data,supplyBelts:state.supplyBeltsData.getSupplyBeltData.data,postLoading:state.waterSchemeData.postWaterSchemeData.isFetching,updateLoading:state.waterSchemeData.updateWaterSchemeData.isFetching};};var mapDispatchToProps={getSchemeDataAction:getSchemeDataAction,postWaterSchemeDataAction:postWaterSchemeDataAction,updateWaterSchemeDataAction:updateWaterSchemeDataAction};var connector=connect(mapStateToProps,mapDispatchToProps);export default connector(Form);","map":null,"metadata":{},"sourceType":"module"}