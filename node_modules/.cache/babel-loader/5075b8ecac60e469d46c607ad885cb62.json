{"ast":null,"code":"import _slicedToArray from\"C:/Users/S.K. COMPUTER/OneDrive/Desktop/react-project/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _asyncToGenerator from\"C:/Users/S.K. COMPUTER/OneDrive/Desktop/react-project/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\S.K. COMPUTER\\\\OneDrive\\\\Desktop\\\\react-project\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import FormikValidationError from\"components/React/FormikValidationError/FormikValidationError\";import toast from\"components/React/ToastNotifier/ToastNotifier\";import Button from\"components/UI/Forms/Buttons\";import{useFormik}from\"formik\";import React,{useCallback,useState}from\"react\";import{useTranslation}from\"react-i18next\";import{connect,shallowEqual,useSelector}from\"react-redux\";import{useHistory}from\"react-router-dom\";import{switchI18nLanguage}from\"store/modules/i18n/i18n\";import{loginUser}from\"store/modules/login/login\";import{addUserDetails}from\"store/modules/userDetails\";import{object as YupObject,string as YupString}from\"yup\";function Login(props){var loginData=props.loginData,loginUser=props.loginUser,switchI18nLanguage=props.switchI18nLanguage;var history=useHistory();var i18nextData=useSelector(function(state){return state.i18nextData;},shallowEqual);var handleLogin=useCallback(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(userDetails){var _loginres$data,_loginres$data$tokens;var loginres,_loginres$data2;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return loginUser(userDetails);case 2:loginres=_context.sent;if(loginres!==null&&loginres!==void 0&&(_loginres$data=loginres.data)!==null&&_loginres$data!==void 0&&(_loginres$data$tokens=_loginres$data.tokens)!==null&&_loginres$data$tokens!==void 0&&_loginres$data$tokens.access){props.addUserDetails(loginres.data);history.push(\"/auth/home\");}else{toast.error(loginres===null||loginres===void 0?void 0:(_loginres$data2=loginres.data)===null||_loginres$data2===void 0?void 0:_loginres$data2.detail);// toast.error(loginres)\n}case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}(),[loginUser,history]);return/*#__PURE__*/React.createElement(\"div\",{className:\"app bg-white\"},/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"auth-wrapper\"},/*#__PURE__*/React.createElement(LoginForm,{handleLogin:handleLogin,authorizing:loginData.isFetching}))));}var mapStateToProps=function mapStateToProps(state){return{loginData:state.loginData};};var mapDispatchToProps={loginUser:loginUser,switchI18nLanguage:switchI18nLanguage,addUserDetails:addUserDetails};var connector=connect(mapStateToProps,mapDispatchToProps);export default connector(Login);var LoginForm=function LoginForm(_ref2){var authorizing=_ref2.authorizing,handleLogin=_ref2.handleLogin;var _useTranslation=useTranslation([\"login\",\"register\"]),t=_useTranslation.t;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),passwordView=_useState2[0],showPassword=_useState2[1];var togglePassword=function togglePassword(){return showPassword(!passwordView);};var _useState3=useState({username:\"\",password:\"\"}),_useState4=_slicedToArray(_useState3,1),initialValue=_useState4[0];var loginValidationSchema=YupObject().shape({username:YupString().required(\"login:input.username.error-required\"),password:YupString().required(\"login:input.password.error-required\")});var _useFormik=useFormik({initialValues:initialValue,validationSchema:loginValidationSchema,onSubmit:function onSubmit(values,_ref3){var setSubmitting=_ref3.setSubmitting;setSubmitting(false);handleLogin(values);}}),values=_useFormik.values,handleChange=_useFormik.handleChange,handleSubmit=_useFormik.handleSubmit,errors=_useFormik.errors,touched=_useFormik.touched;return/*#__PURE__*/React.createElement(\"div\",{className:\"auth-body\"},/*#__PURE__*/React.createElement(\"form\",{className:\"\",onSubmit:handleSubmit,autoComplete:\"off\"},/*#__PURE__*/React.createElement(\"p\",{className:\"\"},\"Water Asset Management System\"),/*#__PURE__*/React.createElement(\"h6\",{className:\"mb-2 font-bold\"},\"CONFIGURATIONS\"),/*#__PURE__*/React.createElement(\"div\",{className:\"auth-form\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group align-vertical\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-4 label\"},t(\"login:input.username.title\")),/*#__PURE__*/React.createElement(\"input\",{className:\"form-control\",name:\"username\",value:values.username,onChange:handleChange,required:true}),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"username\",errors:errors,touched:touched})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group align-vertical mt-4\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-4 label\"},t(\"login:input.password.title\")),/*#__PURE__*/React.createElement(\"input\",{className:\"form-control\",type:\"password\",name:\"password\",value:values.password,onChange:handleChange,required:true}),/*#__PURE__*/React.createElement(\"span\",{className:\"\".concat(passwordView?\"ic-view\":\"ic-hidden\",\" text-coolGray600\"),role:\"button\",onClick:togglePassword}),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"password\",errors:errors,touched:touched})),/*#__PURE__*/React.createElement(\"div\",{className:\"auth-footer\"},/*#__PURE__*/React.createElement(Button,{className:\"btn btn-outlined-primary\",text:t(\"login:title\"),disabled:authorizing,loading:authorizing})))));};","map":null,"metadata":{},"sourceType":"module"}