{"ast":null,"code":"import _objectSpread from\"C:/Users/S.K. COMPUTER/OneDrive/Desktop/react-project/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"C:/Users/S.K. COMPUTER/OneDrive/Desktop/react-project/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/S.K. COMPUTER/OneDrive/Desktop/react-project/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\S.K. COMPUTER\\\\OneDrive\\\\Desktop\\\\react-project\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import{DeleteIcon,EditIconDark}from\"assets/images/xd\";import toast from\"components/React/ToastNotifier/ToastNotifier\";import ConfirmationModal from\"components/UI/ConfirmationModal\";import Button from\"components/UI/Forms/Buttons\";import GeneralModal from\"components/UI/GeneralModal\";import useDeleteConfirmation from\"hooks/useDeleteConfirmation\";import React from\"react\";import{useTranslation}from\"react-i18next\";import{connect}from\"react-redux\";import{deleteComponentInfoAction}from\"store/modules/componentInfo/deleteComponentInfo\";import{getComponentInfoByIdAction}from\"store/modules/componentInfo/getComponentInfoById\";import{getDashboardComponentInfoAction}from\"store/modules/maintainance/dashboardComponentInfo\";import ComponentInfoForm from\"./ComponentInfoForm\";import CostDataHeader,{CostData}from\"./Components/CostData\";import NormalDataHeader,{NormalData}from\"./Components/NormalData\";import RiskDataHeader,{RiskData}from\"./Components/RiskData\";import{SRLWrapper}from\"simple-react-lightbox\";import Thumbnail from\"assets/images/thumbnail.png\";var AssetTable=function AssetTable(props){var _useTranslation=useTranslation([\"maintainance\"]),t=_useTranslation.t;var _useDeleteConfirmatio=useDeleteConfirmation(),editId=_useDeleteConfirmatio.editId,modal=_useDeleteConfirmatio.modal,handleDeleteClick=_useDeleteConfirmatio.handleDeleteClick,resetDeleteData=_useDeleteConfirmatio.resetDeleteData,toggleModal=_useDeleteConfirmatio.toggleModal;var _React$useState=React.useState(null),_React$useState2=_slicedToArray(_React$useState,2),editData=_React$useState2[0],setEditData=_React$useState2[1];var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),modalForm=_React$useState4[0],setModalForm=_React$useState4[1];var _React$useState5=React.useState(false),_React$useState6=_slicedToArray(_React$useState5,2),showRisk=_React$useState6[0],setShowRisk=_React$useState6[1];var _React$useState7=React.useState(false),_React$useState8=_slicedToArray(_React$useState7,2),showCost=_React$useState8[0],setShowCost=_React$useState8[1];var _React$useState9=React.useState(null),_React$useState10=_slicedToArray(_React$useState9,2),tableData=_React$useState10[0],setTableData=_React$useState10[1];var toggleComponentModal=function toggleComponentModal(){if(modalForm){setEditData(null);}setModalForm(!modalForm);};React.useEffect(function(){if(props.schemeSlug){props.getDashboardComponentInfoAction(props.language,props.schemeSlug);}},[props.language,props.schemeSlug]);React.useEffect(function(){if(props.componentData){var newGroupedData={};props.componentData.forEach(function(data){if(data.component.category.name in newGroupedData){newGroupedData[data.component.category.name].push(data);}else{newGroupedData[data.component.category.name]=[data];}});setTableData(newGroupedData);}},[props.componentData]);var handleDelete=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return props.deleteComponentInfoAction(editId);case 3:response=_context.sent;if(response.status===204){toast.success(t(\"home:deleteSuccess\"));props.getDashboardComponentInfoAction(props.language,props.schemeSlug);resetDeleteData();}else{toast.error(t(\"home:deleteError\"));resetDeleteData();}_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.log(_context.t0,\"error\");case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return function handleDelete(){return _ref.apply(this,arguments);};}();var handleEditClick=function handleEditClick(id,component){props.getComponentInfoByIdAction(props.language,id).then(function(res){if(res.data){setEditData(_objectSpread(_objectSpread({},res.data),{},{component:component}));}});};console.log(tableData,\"newGroupedData\");return/*#__PURE__*/React.createElement(\"div\",{className:\"tabular\"},/*#__PURE__*/React.createElement(\"table\",{className:\"table-02\"},/*#__PURE__*/React.createElement(\"tbody\",null,/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"tr\",{className:\"\"},/*#__PURE__*/React.createElement(\"th\",{scope:\"col\",colSpan:6},/*#__PURE__*/React.createElement(Button,{className:\"btn custom-btn mb-2\",text:t(\"maintainance:aci\"),type:\"submit\",onClick:toggleComponentModal// disabled={authorizing}\n// loading={authorizing}\n})),/*#__PURE__*/React.createElement(\"th\",{scope:\"col\",className:showRisk||showCost?\"placeholder\":\"top-headers\",colSpan:3},!showRisk&&!showCost&&t(\"maintainance:mitigation\")),/*#__PURE__*/React.createElement(\"th\",{scope:\"col\",className:showRisk||showCost?\"placeholder\":\"top-headers\",colSpan:3},!showRisk&&!showCost&&t(\"maintainance:responsible\")))),/*#__PURE__*/React.createElement(\"tr\",{className:\"header\"},/*#__PURE__*/React.createElement(\"th\",{scope:\"col\",className:\"bg-header\",style:{width:350,borderRadius:\"5px 0 0 0\"}},t(\"maintainance:assetComponent\")),/*#__PURE__*/React.createElement(\"th\",{scope:\"col\",className:\"bg-header\",colSpan:1,style:{}},t(\"maintainance:dopf\")),/*#__PURE__*/React.createElement(\"th\",{scope:\"col\",className:\"bg-header\",style:{}},t(\"maintainance:lifespan\")),/*#__PURE__*/React.createElement(\"th\",{scope:\"col\",className:\"bg-header\",style:{borderRadius:\"0 5px 0 0\"}},t(\"home:action\")),showCost?/*#__PURE__*/React.createElement(CostDataHeader,{onClick:function onClick(){return setShowCost(false);}}):showRisk?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(RiskDataHeader,{onClick:function onClick(){return setShowRisk(false);}})):/*#__PURE__*/React.createElement(\"th\",{scope:\"col\",rowSpan:2,className:\"expand-header risk-tab\",role:\"button\",onClick:function onClick(){return setShowRisk(!showRisk);}},/*#__PURE__*/React.createElement(\"span\",{className:\"pill\",role:\"button\",onClick:function onClick(){return setShowRisk(!showRisk);}},t(\"maintainance:risk\")),t(\"maintainance:click\")),showRisk||showCost?/*#__PURE__*/React.createElement(React.Fragment,null):/*#__PURE__*/React.createElement(\"th\",{scope:\"col\",rowSpan:2,className:\"expand-header  cost-tab\",role:\"button\",onClick:function onClick(){return setShowCost(!showCost);}},/*#__PURE__*/React.createElement(\"span\",{className:\"pill\",role:\"button\",onClick:function onClick(){return setShowCost(!showCost);}},t(\"maintainance:cost\")),t(\"maintainance:click\")),showRisk||(showCost?/*#__PURE__*/React.createElement(React.Fragment,null):/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(NormalDataHeader,null)))),tableData&&Object.entries(tableData).map(function(item){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{colSpan:showCost?9:4,className:\"component-title\"},item[0]),/*#__PURE__*/React.createElement(\"td\",null)),item[1]instanceof Array&&item[1].map(function(data){return/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex\"},/*#__PURE__*/React.createElement(\"div\",{className:\"component-image-wrapper\"},/*#__PURE__*/React.createElement(SRLWrapper,null,/*#__PURE__*/React.createElement(\"img\",{src:data.componant_picture||Thumbnail,alt:\"\"}))),data.component.name)),/*#__PURE__*/React.createElement(\"td\",null,data.possible_failure),/*#__PURE__*/React.createElement(\"td\",null,data.maintenance_interval,\" \",data.interval_unit),/*#__PURE__*/React.createElement(\"td\",{className:\"action\"},/*#__PURE__*/React.createElement(\"div\",{role:\"button\",onClick:function onClick(e){e.stopPropagation();handleEditClick(data.id,data.component);toggleComponentModal();}},/*#__PURE__*/React.createElement(\"img\",{src:EditIconDark,alt:\"\"})),/*#__PURE__*/React.createElement(\"div\",{role:\"button\",onClick:function onClick(e){e.stopPropagation();handleDeleteClick(data.id);}},/*#__PURE__*/React.createElement(\"img\",{src:DeleteIcon,alt:\"\"}))),!showRisk&&/*#__PURE__*/React.createElement(\"td\",{className:\"\\n                        \".concat(data.resulting_risk_score<=4?\"bg-green\":data.resulting_risk_score<=8?\"bg-yellow\":data.resulting_risk_score<=12?\"bg-orange\":\"bg-red\",\"\\n                        \"),role:\"button\",onClick:function onClick(){return setShowRisk(!showRisk);}},data.resulting_risk_score),showRisk||showCost?/*#__PURE__*/React.createElement(React.Fragment,null):/*#__PURE__*/React.createElement(\"td\",{className:\"text-center\"},props.currency,\" \",data.seggregated_or_unseggregated_cost),showRisk||showCost?/*#__PURE__*/React.createElement(React.Fragment,null,showCost?/*#__PURE__*/React.createElement(CostData,{data:data,currency:props.currency}):showRisk?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(RiskData,{data:data,onClick:function onClick(){return setShowRisk(false);}})):/*#__PURE__*/React.createElement(React.Fragment,null)):/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(NormalData,{data:data})));}));}))),/*#__PURE__*/React.createElement(GeneralModal,{title:t(\"maintainance:addEditaci\"),size:\"xl\",open:modalForm,toggle:function toggle(){if(modalForm){setEditData(null);}toggleComponentModal();}},/*#__PURE__*/React.createElement(ComponentInfoForm,{editData:editData,setEditData:setEditData,toggle:setModalForm})),/*#__PURE__*/React.createElement(ConfirmationModal,{open:modal,handleModal:function handleModal(){return toggleModal();},handleConfirmClick:function handleConfirmClick(){return handleDelete();}}));};var mapStateToProps=function mapStateToProps(state){var _state$waterSchemeDat,_state$waterSchemeDat2;return{language:state.i18nextData.languageType,schemeSlug:(_state$waterSchemeDat=state.waterSchemeData.waterSchemeDetailsData.data)===null||_state$waterSchemeDat===void 0?void 0:_state$waterSchemeDat.slug,currency:(_state$waterSchemeDat2=state.waterSchemeData.waterSchemeDetailsData.data)===null||_state$waterSchemeDat2===void 0?void 0:_state$waterSchemeDat2.currency,componentData:state.maintainanceData.dashboardComponentInfoData.data};};var mapDispatchToProps={getDashboardComponentInfoAction:getDashboardComponentInfoAction,deleteComponentInfoAction:deleteComponentInfoAction,getComponentInfoByIdAction:getComponentInfoByIdAction};var connector=connect(mapStateToProps,mapDispatchToProps);export default connector(AssetTable);","map":null,"metadata":{},"sourceType":"module"}