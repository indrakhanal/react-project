{"ast":null,"code":"import _slicedToArray from\"C:/Users/S.K. COMPUTER/OneDrive/Desktop/react-project/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _objectSpread from\"C:/Users/S.K. COMPUTER/OneDrive/Desktop/react-project/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import Axios from\"axios\";import TokenService from\"../jwt-token/jwt-token\";var basicAuth={username:\"clientid\",password:\"secret\"};var getGrantType=function getGrantType(){return{key:\"grant_type\",value:\"password\"};};// Cancel a request using a cancel token.\nvar cancelToken=Axios.CancelToken;var source=cancelToken.source();export default function initApiRequest(apiDetails,requestData,requestMethod,params,cancelSource){var _TokenService$getAcce,_TokenService$getAcce2;// API URL\nvar url=process.env.REACT_APP_API_ENDPOINT;var access_token=(_TokenService$getAcce=TokenService.getAccessToken())===null||_TokenService$getAcce===void 0?void 0:(_TokenService$getAcce2=_TokenService$getAcce.tokens)===null||_TokenService$getAcce2===void 0?void 0:_TokenService$getAcce2.access;var headers=getRequestHeaders(apiDetails,access_token);var transformedRequestData=transformRequestData(apiDetails,requestData);if(transformedRequestData instanceof FormData){debugger;console.log(transformedRequestData,'transdatattt');}var axiosReqParams=_objectSpread({url:apiDetails.controllerName,method:requestMethod,baseURL:url,responseType:'json',timeout:60*3*1000,cancelToken:cancelSource?cancelSource.token:source.token,headers:headers},transformedRequestData);if(params){axiosReqParams=_objectSpread(_objectSpread({},axiosReqParams),{},{params:params});}return Axios.request(axiosReqParams).then(function(response){return response;}).catch(function(error){var errorResponse=manageErrorResponse(error);throw errorResponse;});};var getRequestHeaders=function getRequestHeaders(apiDetails,access_token){var _TokenService$getAcce3,_TokenService$getAcce4;var headers={\"Content-Type\":\"application/json\"};if(access_token){headers=_objectSpread(_objectSpread({},headers),{},{\"Authorization\":\"Bearer \"+access_token});}switch(apiDetails.requestBodyType){case\"QUERY-STRING\":headers=_objectSpread(_objectSpread({},headers),{},{\"Content-Type\":\"application/x-www-form-urlencoded\"});break;case\"FORM-DATA\":headers=_objectSpread(_objectSpread({},headers),{},{\"Content-Type\":\"multipart/form-data\"});break;case\"NO-AUTH\":if(!((_TokenService$getAcce3=TokenService.getAccessToken())!==null&&_TokenService$getAcce3!==void 0&&(_TokenService$getAcce4=_TokenService$getAcce3.tokens)!==null&&_TokenService$getAcce4!==void 0&&_TokenService$getAcce4.access)){delete headers[\"Authorization\"];}break;default:headers=_objectSpread({},headers);}return headers;};var transformRequestData=function transformRequestData(apiDetails,requestData){var transformedRequestData={data:requestData};switch(apiDetails.requestBodyType){case\"AUTH\":// const grant_type = getGrantType();\n// transformedRequestData.auth = basicAuth;\ntransformedRequestData.data=requestData;// transformedRequestData.data.append(grant_type.key, grant_type.value);\nbreak;case\"FORM-DATA\":transformedRequestData.data=getFormData(requestData);break;case\"QUERY-STRING\":transformedRequestData.data=getQueryString(requestData);break;default:transformedRequestData.data=requestData;break;}return transformedRequestData;};function getQueryString(data){return new URLSearchParams(data);}function getFormData(requestData){var formData=new FormData();console.log(requestData,'transdatattt');var _loop=function _loop(data){if(requestData[data]instanceof Array){requestData[data].forEach(function(dataEl,index){if(dataEl instanceof Object){Object.keys(dataEl).forEach(function(elKey){return formData.append(\"\".concat(data,\"[\").concat(index,\"].\").concat(elKey),dataEl[elKey]);});}});}else if(requestData[data]instanceof File){formData.append(data,requestData[data]);}else if(requestData[data]instanceof Object){Object.entries(requestData[data]).forEach(function(_ref){var _ref2=_slicedToArray(_ref,2),key=_ref2[0],value=_ref2[1];return formData.append(\"\".concat(data,\".\").concat(key),value);});}else{console.log(data,\"data insodez\");formData.append(data,requestData[data]);}};for(var data in requestData){_loop(data);}return formData;}var manageErrorResponse=function manageErrorResponse(error){var message=error.message,config=error.config,code=error.code,request=error.request,response=error.response,isAxiosError=error.isAxiosError;var errorResponse={message:message,// Something happened in setting up the request that triggered an Error\ndata:null,status:code||400,noconnection:false,config:config,// Request Params Configs\nisAxiosError:isAxiosError//If Axios Error\n};if(response){errorResponse.data=response.data;// The server responded with a status code and data\n}else if(request){errorResponse.message=\"Server could not be reached.\";// No response was received\nerrorResponse.noconnection=true;}return errorResponse;};","map":null,"metadata":{},"sourceType":"module"}