{"ast":null,"code":"import _toConsumableArray from\"C:/Users/S.K. COMPUTER/OneDrive/Desktop/react-project/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"C:/Users/S.K. COMPUTER/OneDrive/Desktop/react-project/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import GeneralChart from\"components/UI/Charts/General\";import CustomCheckBox from\"components/UI/CustomCheckbox\";import{getFiscalYearData,getMonthByLanguageAndScheme,getNumberByLanguage}from\"i18n/i18n\";import React,{useEffect,useState}from\"react\";import{useTranslation}from\"react-i18next\";import{connect}from\"react-redux\";import DataTable from\"./DataTable\";var BarChartThisYear=function BarChartThisYear(props){var selected=props.selected,setSelected=props.setSelected;var _useTranslation=useTranslation(),t=_useTranslation.t;var _useState=useState(),_useState2=_slicedToArray(_useState,2),chartData=_useState2[0],setChartData=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),seriesData=_useState4[0],setSeriesData=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),tableData=_useState6[0],setTableData=_useState6[1];var options=[{id:\"actual_unsegregated\",name:\"\".concat(t(\"home:actual\"),\" \").concat(t(\"home:unsegregated\")),color:\"#e5f1ff\"},{id:\"actual_material\",name:\"\".concat(t(\"home:actual\"),\" \").concat(t(\"home:consumable\")),color:\"#69a7f1\"},{id:\"actual_labor\",name:\"\".concat(t(\"home:actual\"),\" \").concat(t(\"home:labour\")),color:\"#2680eb\"},{id:\"actual_replacement\",name:\"\".concat(t(\"home:actual\"),\" \").concat(t(\"home:replacement\")),color:\"#accef7\"},{id:\"expected_unsegregated\",name:\"\".concat(t(\"home:expected\"),\" \").concat(t(\"home:unsegregated\")),color:\"#ffefdb\"},{id:\"expected_material\",name:\"\".concat(t(\"home:expected\"),\" \").concat(t(\"home:consumable\")),color:\"#f1b369\"},{id:\"expected_labor\",name:\"\".concat(t(\"home:expected\"),\" \").concat(t(\"home:labour\")),color:\"#eb9126\"},{id:\"expected_replacement\",name:\"\".concat(t(\"home:expected\"),\" \").concat(t(\"home:replacement\")),color:\"#f7d5ac\"}];useEffect(function(){if(props.maintainanceCost&&props.intervalData){var _props$schemeDetails;var fiscalYearArray=getFiscalYearData(props.intervalData,(_props$schemeDetails=props.schemeDetails)===null||_props$schemeDetails===void 0?void 0:_props$schemeDetails.system_date_format);var sortAndMapArray=function sortAndMapArray(array,monthKey,key,color){return fiscalYearArray===null||fiscalYearArray===void 0?void 0:fiscalYearArray.map(function(item){var findElement=array===null||array===void 0?void 0:array.find(function(inc){var _inc$monthKey,_inc$monthKey$toStrin;console.log(inc,item,\"testaaaa\");return+inc[monthKey]<10?+((_inc$monthKey=inc[monthKey])===null||_inc$monthKey===void 0?void 0:(_inc$monthKey$toStrin=_inc$monthKey.toString())===null||_inc$monthKey$toStrin===void 0?void 0:_inc$monthKey$toStrin.replace(\"0\",\"\"))===+item:+inc[monthKey]===+item;});return{value:findElement?findElement[key]:0,itemStyle:{color:color}};});};var _chartData={years:fiscalYearArray===null||fiscalYearArray===void 0?void 0:fiscalYearArray.map(function(item){var _props$schemeDetails2;return getMonthByLanguageAndScheme(item,(_props$schemeDetails2=props.schemeDetails)===null||_props$schemeDetails2===void 0?void 0:_props$schemeDetails2.system_date_format);}),actual_unsegregated:sortAndMapArray(props.maintainanceCost.actual_cost,\"maintenance_date__month\",\"unsegregated_cost\",\"rgba(196,196,196,1)\"),actual_material:sortAndMapArray(props.maintainanceCost.actual_cost,\"maintenance_date__month\",\"material_cost\",\"rgba(215,215,215,1)\"),actual_labor:sortAndMapArray(props.maintainanceCost.actual_cost,\"maintenance_date__month\",\"labour_cost\",\"rgba(229,229,229,1)\"),actual_replacement:sortAndMapArray(props.maintainanceCost.actual_cost,\"maintenance_date__month\",\"replacement_cost\",\"rgba(242,242,242,1)\"),expected_unsegregated:sortAndMapArray(props.maintainanceCost.expected_cost,\"next_action__month\",\"unsegregated_cost\",\"rgba(38,128,235,1)\"),expected_material:sortAndMapArray(props.maintainanceCost.expected_cost,\"next_action__month\",\"material_cost\",\"rgba(139,173,213,1)\"),expected_labor:sortAndMapArray(props.maintainanceCost.expected_cost,\"next_action__month\",\"labour_cost\",\"rgba(189,213,242,1)\"),expected_replacement:sortAndMapArray(props.maintainanceCost.expected_cost,\"next_action__month\",\"replacement_cost\",\"rgba(204,221,234,1)\"),expected_total:props.maintainanceCost.expected_cost.map(function(item){return{date:item.next_action__month,value:item.actual_cost_total||0};}),actual_total:props.maintainanceCost.actual_cost.map(function(item){return{date:item.next_action__month,value:item.actual_cost_total||0};})};setChartData(_chartData);}},[props.language,props.maintainanceCost,props.intervalData]);var handleSelect=function handleSelect(name){if(selected!==null&&selected!==void 0&&selected.includes(name)){var filteredData=selected.filter(function(item){return item!==name;});setSelected(filteredData);}else{setSelected([].concat(_toConsumableArray(selected),[name]));}};useEffect(function(){var selectedData=selected.map(function(item){var _options$find,_options$find2;return{name:(_options$find=options.find(function(opt){return opt.id===item;}))===null||_options$find===void 0?void 0:_options$find.name,type:\"bar\",stack:item!==null&&item!==void 0&&item.includes(\"expec\")?\"expected\":\"actual\",areaStyle:{color:(_options$find2=options.find(function(opt){return opt.id===item;}))===null||_options$find2===void 0?void 0:_options$find2.color},data:chartData&&chartData[item]};});var tableData=selected.map(function(item){var _options$find3,_options$find4;return{name:((_options$find3=options.find(function(opt){return opt.id===item;}))===null||_options$find3===void 0?void 0:_options$find3.name)||\"\",color:((_options$find4=options.find(function(opt){return opt.id===item;}))===null||_options$find4===void 0?void 0:_options$find4.color)||\"\",data:chartData&&chartData[item]};});console.log(tableData,\"tableDatatableData\");setSeriesData(selectedData);setTableData(tableData);},[chartData,selected]);var optionData={tooltip:{trigger:\"axis\",axisPointer:{type:\"shadow\"}// formatter: handleCustomTooltip,\n},legend:{show:false},grid:{left:\"3%\",right:\"4%\",bottom:\"3%\",top:\"8%\",containLabel:true},xAxis:{type:\"category\",data:chartData===null||chartData===void 0?void 0:chartData.years,axisLabel:{formatter:function formatter(data){return(data===null||data===void 0?void 0:data.replace(\"Year\",\"\"))||\" \";}}},yAxis:{type:\"value\",axisLabel:{formatter:function formatter(name){return getNumberByLanguage(name);}}},series:seriesData};return/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-9\"},/*#__PURE__*/React.createElement(GeneralChart,{minHeight:300,options:optionData}),(tableData===null||tableData===void 0?void 0:tableData.length)>0&&/*#__PURE__*/React.createElement(DataTable,{months:true,years:chartData===null||chartData===void 0?void 0:chartData.years,tableData:tableData})),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-3 chartOptions\"},/*#__PURE__*/React.createElement(\"h6\",null,\"Select\"),/*#__PURE__*/React.createElement(\"p\",null,\"Visualization Parameters\"),/*#__PURE__*/React.createElement(\"ul\",null,options.map(function(item){return/*#__PURE__*/React.createElement(\"li\",{key:item.id},/*#__PURE__*/React.createElement(CustomCheckBox,{id:\"\"+item.id,label:item.name,onChange:function onChange(e){return handleSelect(item.id);},checked:selected.includes(item.id)}));}))));};var mapStateToProps=function mapStateToProps(state){return{schemeDetails:state.waterSchemeData.waterSchemeDetailsData.data,language:state.i18nextData.languageType,maintainanceCost:state.reportData.maintainanceCostData.data,intervalData:state.waterSchemeData.getYearIntervals.data};};var mapDispatchToProps={};var connector=connect(mapStateToProps,mapDispatchToProps);export default connector(BarChartThisYear);","map":null,"metadata":{},"sourceType":"module"}