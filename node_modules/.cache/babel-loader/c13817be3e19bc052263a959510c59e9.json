{"ast":null,"code":"import _objectSpread from\"C:/Users/S.K. COMPUTER/OneDrive/Desktop/react-project/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"C:/Users/S.K. COMPUTER/OneDrive/Desktop/react-project/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/S.K. COMPUTER/OneDrive/Desktop/react-project/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\S.K. COMPUTER\\\\OneDrive\\\\Desktop\\\\react-project\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import NepaliDatePicker from\"components/React/Datepicker/Datepicker\";import EnglishDatePicker from\"components/React/EnglishDatepicker/EnglishDatepicker\";import FormikValidationError from\"components/React/FormikValidationError/FormikValidationError\";import{default as StyledSelect}from\"components/React/StyledSelect/CreatableSelect\";import toast from\"components/React/ToastNotifier/ToastNotifier\";import Button from\"components/UI/Forms/Buttons\";import{GeneralCard}from\"components/UI/GeneralCard\";import GeneralModal from\"components/UI/GeneralModal\";import TooltipLabel from\"components/UI/TooltipLabel\";import{SYSTEM_DATE_FORMAT_OPTIONS}from\"constants/constants\";import{useFormik}from\"formik\";import{getNumberByLanguage}from\"i18n/i18n\";import React,{useState}from\"react\";import{useTranslation}from\"react-i18next\";import{connect,useDispatch,useSelector}from\"react-redux\";import{updateWaterSchemeDetailsAction}from\"store/modules/waterScheme/updateWaterSchemeDetails\";import{getWaterSchemeDetailsAction}from\"store/modules/waterScheme/waterSchemeDetails\";import formatDate from\"utils/utilsFunction/date-converter\";import{generalInfoInitialValues,generalInfoValidationSchema}from\"./scheme\";var GeneralInfo=function GeneralInfo(props){var _Date,_values$system_date_f2,_values$system_date_f3;var _useTranslation=useTranslation(\"home\"),t=_useTranslation.t;var dispatch=useDispatch();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),edit=_useState2[0],setEdit=_useState2[1];var _useState3=useState(generalInfoInitialValues),_useState4=_slicedToArray(_useState3,2),initialData=_useState4[0],setInitialData=_useState4[1];var userDetails=useSelector(function(state){return state.userDetails;});var waterSchemeDetails=useSelector(function(state){return state.waterSchemeData.waterSchemeDetailsData.data;});var _useFormik=useFormik({enableReinitialize:true,initialValues:initialData,validationSchema:generalInfoValidationSchema,onSubmit:function(){var _onSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(values){var _values$system_date_f;var requestData,res,_Object$values,_errors;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:requestData=_objectSpread(_objectSpread({},values),{},{system_date_format:values===null||values===void 0?void 0:(_values$system_date_f=values.system_date_format)===null||_values$system_date_f===void 0?void 0:_values$system_date_f.value});_context.next=3;return props.updateWaterSchemeDetailsAction(waterSchemeDetails===null||waterSchemeDetails===void 0?void 0:waterSchemeDetails.system_date_format,waterSchemeDetails===null||waterSchemeDetails===void 0?void 0:waterSchemeDetails.slug,requestData);case 3:res=_context.sent;if(res.status===201||res.status===200){toast.success(t(\"home:updateSuccess\"));toggleModal();}else{_errors=(_Object$values=Object.values(res.data))===null||_Object$values===void 0?void 0:_Object$values.map(function(item){toast.error(item[0]);});}case 5:case\"end\":return _context.stop();}}},_callee);}));function onSubmit(_x){return _onSubmit.apply(this,arguments);}return onSubmit;}()}),values=_useFormik.values,errors=_useFormik.errors,touched=_useFormik.touched,setFieldTouched=_useFormik.setFieldTouched,setFieldValue=_useFormik.setFieldValue,handleChange=_useFormik.handleChange,handleBlur=_useFormik.handleBlur,handleSubmit=_useFormik.handleSubmit;var toggleModal=function toggleModal(){return setEdit(!edit);};React.useEffect(function(){if(userDetails!==null&&userDetails!==void 0&&userDetails.slug){dispatch(getWaterSchemeDetailsAction(userDetails===null||userDetails===void 0?void 0:userDetails.slug));}},[userDetails]);React.useEffect(function(){if(waterSchemeDetails){setInitialData({currency:(waterSchemeDetails===null||waterSchemeDetails===void 0?void 0:waterSchemeDetails.currency)||\"\",location:waterSchemeDetails===null||waterSchemeDetails===void 0?void 0:waterSchemeDetails.location,scheme_name:waterSchemeDetails===null||waterSchemeDetails===void 0?void 0:waterSchemeDetails.scheme_name,system_built_date:formatDate(waterSchemeDetails===null||waterSchemeDetails===void 0?void 0:waterSchemeDetails.system_built_date),longitude:waterSchemeDetails===null||waterSchemeDetails===void 0?void 0:waterSchemeDetails.longitude,latitude:waterSchemeDetails===null||waterSchemeDetails===void 0?void 0:waterSchemeDetails.latitude,water_source:waterSchemeDetails===null||waterSchemeDetails===void 0?void 0:waterSchemeDetails.water_source,daily_target:\"\"+(waterSchemeDetails===null||waterSchemeDetails===void 0?void 0:waterSchemeDetails.daily_target),period:\"\"+(waterSchemeDetails===null||waterSchemeDetails===void 0?void 0:waterSchemeDetails.period)||\"\",system_date_format:(SYSTEM_DATE_FORMAT_OPTIONS===null||SYSTEM_DATE_FORMAT_OPTIONS===void 0?void 0:SYSTEM_DATE_FORMAT_OPTIONS.find(function(item){return item.value===(waterSchemeDetails===null||waterSchemeDetails===void 0?void 0:waterSchemeDetails.system_date_format);}))||null,tool_start_date:waterSchemeDetails===null||waterSchemeDetails===void 0?void 0:waterSchemeDetails.tool_start_date});}},[waterSchemeDetails]);var handleCreateOption=function handleCreateOption(event){var waterDource=values.water_source;waterDource===null||waterDource===void 0?void 0:waterDource.push({label:event,value:event});setFieldValue(\"water_source\",waterDource);};console.log(errors,\"<<<<<<\");return/*#__PURE__*/React.createElement(GeneralCard,{title:t(\"home:generalInformation\"),className:\"text-left\",action:toggleModal},/*#__PURE__*/React.createElement(\"div\",{className:\"data-info\"},/*#__PURE__*/React.createElement(\"h6\",{className:\"title\"},t(\"home:scheme\"),\" \",t(\"home:name\"),\":\",\" \"),/*#__PURE__*/React.createElement(\"p\",{className:\"desc\"},waterSchemeDetails===null||waterSchemeDetails===void 0?void 0:waterSchemeDetails.scheme_name)),/*#__PURE__*/React.createElement(\"div\",{className:\"data-info\"},/*#__PURE__*/React.createElement(\"h6\",{className:\"title\"},t(\"home:location\"),\": \"),/*#__PURE__*/React.createElement(\"p\",{className:\"desc\"},waterSchemeDetails===null||waterSchemeDetails===void 0?void 0:waterSchemeDetails.location)),/*#__PURE__*/React.createElement(\"div\",{className:\"data-info\"},/*#__PURE__*/React.createElement(\"h6\",{className:\"title\"},t(\"home:waterSource\"),\": \"),/*#__PURE__*/React.createElement(\"p\",{className:\"desc\"},waterSchemeDetails===null||waterSchemeDetails===void 0?void 0:waterSchemeDetails.water_source)),/*#__PURE__*/React.createElement(\"div\",{className:\"data-info\"},/*#__PURE__*/React.createElement(\"h6\",{className:\"title\"},t(\"home:systemBuiltDate\"),\" \"),/*#__PURE__*/React.createElement(\"p\",{className:\"desc\"},getNumberByLanguage((_Date=new Date(waterSchemeDetails===null||waterSchemeDetails===void 0?void 0:waterSchemeDetails.system_built_date))===null||_Date===void 0?void 0:_Date.toLocaleDateString()))),/*#__PURE__*/React.createElement(GeneralModal,{open:edit,toggle:toggleModal,title:t(\"home:edit\")+\" \"+t(\"home:generalInformation\"),size:\"xl\"},/*#__PURE__*/React.createElement(\"form\",{onSubmit:function onSubmit(e){e.preventDefault();handleSubmit();},className:\"verticalForm\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group \"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-1\"},t(\"home:scheme\"),\" \",t(\"home:name\"),\":\"),/*#__PURE__*/React.createElement(\"input\",{className:\"form-control\",name:\"scheme_name\",value:values.scheme_name,onChange:handleChange,onBlur:handleBlur}),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"scheme_name\",errors:errors,touched:touched}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group \"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-1\"},t(\"home:location\"),\":\"),/*#__PURE__*/React.createElement(\"input\",{className:\"form-control\",name:\"location\",value:values.location,onChange:handleChange,onBlur:handleBlur}),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"location\",errors:errors,touched:touched}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group \"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-1\"},t(\"home:waterSource\"),\" \",/*#__PURE__*/React.createElement(TooltipLabel,{id:\"sowsas\",text:\"Sources of water such as (ground water, spring, rivers)\"}),\":\"),/*#__PURE__*/React.createElement(\"input\",{className:\"form-control\",name:\"water_source\",value:values.water_source,onChange:handleChange,onBlur:handleBlur}),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"water_source\",errors:errors,touched:touched}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group \"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-1\"},t(\"home:dailyTarget\"),\" \",/*#__PURE__*/React.createElement(TooltipLabel,{id:\"twspd\",text:\"Total water supply (in liters) per day \"}),\":\"),/*#__PURE__*/React.createElement(\"input\",{className:\"form-control\",name:\"daily_target\",type:\"number\",value:values.daily_target,onChange:handleChange,onBlur:handleBlur}),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"daily_target\",errors:errors,touched:touched}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group \"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-1\"},t(\"home:vsf\"),\" ( Year )\",\" \",/*#__PURE__*/React.createElement(TooltipLabel,{id:\"sbdates\",text:\"The number of years for which the data will be visualized\"}),\":\"),/*#__PURE__*/React.createElement(\"input\",{className:\"form-control\",name:\"period\",type:\"number\",value:values.period,onChange:handleChange,onBlur:handleBlur}),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"period\",errors:errors,touched:touched}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group \"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-1\"},t(\"home:currency\"),\" \",/*#__PURE__*/React.createElement(TooltipLabel,{id:\"curr\",text:\"The unit of currency to be used. \"}),\":\"),/*#__PURE__*/React.createElement(\"input\",{className:\"form-control\",name:\"currency\",type:\"text\",value:values.currency,onChange:handleChange,onBlur:handleBlur}),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"currency\",errors:errors,touched:touched}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group \"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-1\"},t(\"home:systemDateFormat\"),\" \",/*#__PURE__*/React.createElement(TooltipLabel,{id:\"systemDateFormat\",text:\"The format and month names to display with visualization. Current options are EN for English and NP for Nepali.\"}),\":\"),/*#__PURE__*/React.createElement(StyledSelect,{name:\"system_date_format\",value:values===null||values===void 0?void 0:values.system_date_format,options:SYSTEM_DATE_FORMAT_OPTIONS,onChange:function onChange(_ref){var name=_ref.name,value=_ref.value;setFieldValue(name,value);},onBlur:function onBlur(){setFieldTouched(\"system_date_format\",true);}}),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"location\",errors:errors,touched:touched}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group \"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-1\"},t(\"home:systemBuiltDate\"),\" \",/*#__PURE__*/React.createElement(TooltipLabel,{id:\"sbdate\",text:\"Calendar date on which a Water System was built.It does not affect the book \\nkeeping or in any financial projection.\"}),\":\"),((_values$system_date_f2=values.system_date_format)===null||_values$system_date_f2===void 0?void 0:_values$system_date_f2.value)===\"nep\"?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(NepaliDatePicker,{value:values.system_built_date,name:\"system_built_date\",onChange:function onChange(e){setFieldValue(\"system_built_date\",e);}})):/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(EnglishDatePicker,{name:\"system_built_date\",value:values.system_built_date,handleChange:function handleChange(e){setFieldValue(\"system_built_date\",formatDate(e));}})),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"system_built_date\",errors:errors,touched:touched}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group \"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-1\"},t(\"home:longitude\"),\":\"),/*#__PURE__*/React.createElement(\"input\",{className:\"form-control\",name:\"longitude\",type:\"text\",value:values.longitude,onChange:handleChange,onBlur:handleBlur}),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"longitude\",errors:errors,touched:touched}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group \"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-1\"},t(\"home:latitude\"),\":\"),/*#__PURE__*/React.createElement(\"input\",{className:\"form-control\",name:\"latitude\",type:\"text\",value:values.latitude,onChange:handleChange,onBlur:handleBlur}),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"latitude\",errors:errors,touched:touched}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group \"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-1\"},t(\"home:toolStartDate\"),\" \",/*#__PURE__*/React.createElement(TooltipLabel,{id:\"tsdate\",text:\"The calendar date on which this tool is instantiated for this water system. All projections and records starts at this date. \"}),\":\"),((_values$system_date_f3=values.system_date_format)===null||_values$system_date_f3===void 0?void 0:_values$system_date_f3.value)===\"nep\"?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(NepaliDatePicker,{value:values.tool_start_date,name:\"tool_start_date\",onChange:function onChange(e){setFieldValue(\"tool_start_date\",e);}})):/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(EnglishDatePicker,{name:\"tool_start_date\",value:values.tool_start_date,handleChange:function handleChange(e){setFieldValue(\"tool_start_date\",formatDate(e));}})),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"location\",errors:errors,touched:touched}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 text-right mt-5\"},/*#__PURE__*/React.createElement(Button,{className:\"btn custom-btn  mr-3\",text:t(\"home:save\"),type:\"submit\",loading:props.buttonLoading,disabled:props.buttonLoading}),/*#__PURE__*/React.createElement(Button,{className:\"btn custom-btn-outlined mr-3\",text:t(\"home:cancel\"),type:\"button\",onClick:toggleModal}))))));};var mapStateToProps=function mapStateToProps(state){return{buttonLoading:state.waterSchemeData.updateWaterSchemeDetails.isFetching};};var mapDispatchToProps={updateWaterSchemeDetailsAction:updateWaterSchemeDetailsAction};var connector=connect(mapStateToProps,mapDispatchToProps);export default connector(GeneralInfo);","map":null,"metadata":{},"sourceType":"module"}