{"ast":null,"code":"import _objectSpread from\"C:/Users/S.K. COMPUTER/OneDrive/Desktop/react-project/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"C:/Users/S.K. COMPUTER/OneDrive/Desktop/react-project/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/S.K. COMPUTER/OneDrive/Desktop/react-project/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\S.K. COMPUTER\\\\OneDrive\\\\Desktop\\\\react-project\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import NepaliDatePicker from\"components/React/Datepicker/Datepicker\";import EnglishDatePicker from\"components/React/EnglishDatepicker/EnglishDatepicker\";import FormikValidationError from\"components/React/FormikValidationError/FormikValidationError\";import toast from\"components/React/ToastNotifier/ToastNotifier\";import Button from\"components/UI/Forms/Buttons\";import{GeneralCard}from\"components/UI/GeneralCard\";import{useFormik}from\"formik\";import React from\"react\";import{useTranslation}from\"react-i18next\";import{connect}from\"react-redux\";import{getNotificationDetailsAction}from\"store/modules/notifications/getNotifications\";import{postNotificationsAction}from\"store/modules/notifications/postNotifications\";import{updateNotificationsAction}from\"store/modules/notifications/updateNotifications\";import formatDate from\"utils/utilsFunction/date-converter\";import{createNotificationInitialValues,createNotificationValidationSchema}from\"./scheme\";var GeneralInfo=function GeneralInfo(props){var _useTranslation=useTranslation(\"home\"),t=_useTranslation.t;var _React$useState=React.useState(createNotificationInitialValues),_React$useState2=_slicedToArray(_React$useState,2),initialValues=_React$useState2[0],setInitialValues=_React$useState2[1];React.useEffect(function(){if(props.schemeDetails){var _props$schemeDetails;props.getNotificationDetailsAction((_props$schemeDetails=props.schemeDetails)===null||_props$schemeDetails===void 0?void 0:_props$schemeDetails.slug);}},[props.schemeDetails]);React.useEffect(function(){if(props.notificationDetails&&props.notificationDetails instanceof Array&&props.notificationDetails[0]){setInitialValues(props.notificationDetails[0]);}},[props.notificationDetails]);var _useFormik=useFormik({enableReinitialize:true,initialValues:initialValues,validationSchema:createNotificationValidationSchema,onSubmit:function(){var _onSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(values,_ref){var _values$system_date_f;var resetForm,response,requestData,_props$notificationDe,_props$schemeDetails2,errorList;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:resetForm=_ref.resetForm;requestData=_objectSpread(_objectSpread({},values),{},{system_date_format:values===null||values===void 0?void 0:(_values$system_date_f=values.system_date_format)===null||_values$system_date_f===void 0?void 0:_values$system_date_f.value});if(!(props.notificationDetails&&props.notificationDetails.length>0)){_context.next=8;break;}_context.next=5;return props.updateNotificationsAction((_props$notificationDe=props.notificationDetails[0])===null||_props$notificationDe===void 0?void 0:_props$notificationDe.id,requestData);case 5:response=_context.sent;_context.next=11;break;case 8:_context.next=10;return props.postNotificationsAction(requestData);case 10:response=_context.sent;case 11:console.log(response,\"responsss\");if(response.status===201||response.status===200){props.getNotificationDetailsAction((_props$schemeDetails2=props.schemeDetails)===null||_props$schemeDetails2===void 0?void 0:_props$schemeDetails2.slug);toast.success(\"Notification Updated Successfully\");}else{errorList=response.data&&response.data.error;if(errorList instanceof Array){errorList.forEach(function(item){toast.error(item);});}}case 13:case\"end\":return _context.stop();}}},_callee);}));function onSubmit(_x,_x2){return _onSubmit.apply(this,arguments);}return onSubmit;}()}),values=_useFormik.values,errors=_useFormik.errors,touched=_useFormik.touched,setFieldTouched=_useFormik.setFieldTouched,setFieldValue=_useFormik.setFieldValue,handleChange=_useFormik.handleChange,handleBlur=_useFormik.handleBlur,handleSubmit=_useFormik.handleSubmit;console.log(props.notificationDetails,\"initialValuesinitialValues\");return/*#__PURE__*/React.createElement(\"div\",{className:\"container py-3 \"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-12\"},/*#__PURE__*/React.createElement(GeneralCard,{title:t(\"home:updateNotifications\"),className:\"text-left\"},/*#__PURE__*/React.createElement(\"form\",{onSubmit:function onSubmit(e){e.preventDefault();handleSubmit();},className:\"verticalForm\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-6\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group \"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-1 \"},t(\"home:initialDate\"),\":\"),props.schemeDetails&&props.schemeDetails.system_date_format===\"nep\"?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(NepaliDatePicker,{value:values.initial_date,name:\"initial_date\",onChange:function onChange(e){setFieldValue(\"initial_date\",e);}})):/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(EnglishDatePicker,{name:\"initial_date\",value:values.initial_date,handleChange:function handleChange(e){setFieldValue(\"initial_date\",formatDate(e));}})),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"initial_date\",errors:errors,touched:touched}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-6\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group \"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-1 \"},t(\"home:inp\"),\":\"),/*#__PURE__*/React.createElement(\"input\",{className:\"form-control\",name:\"income_notification_period\",value:values.income_notification_period,onChange:handleChange,onBlur:handleBlur}),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"income_notification_period\",errors:errors,touched:touched}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-6\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group \"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-1 \"},t(\"home:enp\"),\":\"),/*#__PURE__*/React.createElement(\"input\",{className:\"form-control\",name:\"expenditure_notification_period\",value:values.expenditure_notification_period,onChange:handleChange,onBlur:handleBlur}),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"expenditure_notification_period\",errors:errors,touched:touched}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-6\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group \"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-1 \"},t(\"home:trnp\"),\":\"),/*#__PURE__*/React.createElement(\"input\",{className:\"form-control\",name:\"test_result_notification_period\",value:values.test_result_notification_period,onChange:handleChange,onBlur:handleBlur}),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"test_result_notification_period\",errors:errors,touched:touched}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-6\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group \"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-1 \"},t(\"home:srnp\"),\":\"),/*#__PURE__*/React.createElement(\"input\",{className:\"form-control\",name:\"supply_record_notification_period\",value:values.supply_record_notification_period,onChange:handleChange,onBlur:handleBlur}),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"supply_record_notification_period\",errors:errors,touched:touched}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-6\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group \"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-1 \"},t(\"home:mnb\"),\":\"),/*#__PURE__*/React.createElement(\"input\",{className:\"form-control\",name:\"maintenance_notify_before\",value:values.maintenance_notify_before,onChange:handleChange,onBlur:handleBlur}),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"maintenance_notify_before\",errors:errors,touched:touched}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-lg-6\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group \"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-1 \"},t(\"home:mna\"),\":\"),/*#__PURE__*/React.createElement(\"input\",{className:\"form-control\",name:\"maintenance_notify_after\",value:values.maintenance_notify_after,onChange:handleChange,onBlur:handleBlur}),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"maintenance_notify_after\",errors:errors,touched:touched}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 text-right mt-5\"},/*#__PURE__*/React.createElement(Button,{className:\"btn custom-btn  mr-3\",text:t(\"home:save\"),type:\"submit\",disabled:props.loading,loading:props.loading}))))))));};var mapStateToProps=function mapStateToProps(state){return{schemeDetails:state.waterSchemeData.waterSchemeDetailsData.data,notificationDetails:state.notifications.getNotifications.data,loading:state.notifications.updateNotifications.isFetching};};var mapDispatchToProps={updateNotificationsAction:updateNotificationsAction,getNotificationDetailsAction:getNotificationDetailsAction,postNotificationsAction:postNotificationsAction};var connector=connect(mapStateToProps,mapDispatchToProps);export default connector(GeneralInfo);","map":null,"metadata":{},"sourceType":"module"}