{"ast":null,"code":"import _objectSpread from\"C:/Users/S.K. COMPUTER/OneDrive/Desktop/react-project/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"C:/Users/S.K. COMPUTER/OneDrive/Desktop/react-project/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/S.K. COMPUTER/OneDrive/Desktop/react-project/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\S.K. COMPUTER\\\\OneDrive\\\\Desktop\\\\react-project\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import NepaliDatePicker from\"components/React/Datepicker/Datepicker\";import EnglishDatePicker from\"components/React/EnglishDatepicker/EnglishDatepicker\";import FormikValidationError from\"components/React/FormikValidationError/FormikValidationError\";import toast from\"components/React/ToastNotifier/ToastNotifier\";import Button from\"components/UI/Forms/Buttons\";import{useFormik}from\"formik\";import React from\"react\";import{connect}from\"react-redux\";import{getWaterTarrifsAction}from\"store/modules/waterTarrifs/getWaterTarrifs\";import{postFixedRateWaterTariffAction}from\"store/modules/waterTarrifs/postFixedRateWaterTariff\";import{updateFixedRateWaterTariffAction}from\"store/modules/waterTarrifs/updateFixedBasedWaterTariff\";import formatDate from\"utils/utilsFunction/date-converter\";import*as Yup from\"yup\";import{useTranslation}from\"react-i18next\";import{getUsIncomeEstimateThisYearAction}from\"store/modules/waterTarrifs/getIncomeEstimateThisYear\";import TooltipLabel from\"components/UI/TooltipLabel\";var validationSchema=Yup.object({rate_for_institution:Yup.string().required(\"This field is required\"),rate_for_household:Yup.string().required(\"This field is required\"),rate_for_public:Yup.string().required(\"This field is required\"),rate_for_commercial:Yup.string().required(\"This field is required\"),apply_date:Yup.string().required(\"This field is required\"),estimated_paying_connection_household:Yup.string().required(\"This field is required\"),estimated_paying_connection_institution:Yup.string().required(\"This field is required\"),estimated_paying_connection_public:Yup.string().required(\"This field is required\"),estimated_paying_connection_commercial:Yup.string().required(\"This field is required\")});var UseBasedForm=function UseBasedForm(props){var _props$scheme;var _useTranslation=useTranslation(),t=_useTranslation.t;var _React$useState=React.useState({terif_type:\"Fixed\",rate_for_institution:\"\",rate_for_household:\"\",rate_for_public:\"\",rate_for_commercial:\"\",apply_date:\"\",estimated_paying_connection_household:\"\",estimated_paying_connection_institution:\"\",estimated_paying_connection_public:\"\",estimated_paying_connection_commercial:\"\"}),_React$useState2=_slicedToArray(_React$useState,2),initialData=_React$useState2[0],setInitialData=_React$useState2[1];React.useEffect(function(){if(props.scheme){setInitialData({terif_type:\"Fixed\",rate_for_institution:\"\",rate_for_household:\"\",rate_for_public:\"\",rate_for_commercial:\"\",apply_date:\"\",estimated_paying_connection_household:\"\",estimated_paying_connection_institution:\"\",estimated_paying_connection_public:\"\",estimated_paying_connection_commercial:\"\"});}},[props.scheme]);var _useFormik=useFormik({enableReinitialize:true,initialValues:initialData,validationSchema:validationSchema,onSubmit:function(){var _onSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(values,_ref){var resetForm,response,errorList;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:resetForm=_ref.resetForm;if(!props.editData){_context.next=7;break;}_context.next=4;return props.updateFixedRateWaterTariffAction(props.language,props.editData.id,values);case 4:response=_context.sent;_context.next=10;break;case 7:_context.next=9;return props.postFixedRateWaterTariffAction(props.language,values);case 9:response=_context.sent;case 10:if(response.status===201||response.status===200){props.getUsIncomeEstimateThisYearAction(props.schemeSlug);if(response.status===201){resetForm();toast.success(t(\"home:postSuccess\"));}else{setInitialData({terif_type:\"Fixed\",rate_for_institution:\"\",rate_for_household:\"\",rate_for_public:\"\",rate_for_commercial:\"\",apply_date:\"\",estimated_paying_connection_household:\"\",estimated_paying_connection_institution:\"\",estimated_paying_connection_public:\"\",estimated_paying_connection_commercial:\"\"});// props.getOtherExpensesAction(props.language);\n// props.getOtherExpensesAction(props.language);\ntoast.success(t(\"home:updateSuccess\"));}props.getWaterTarrifsAction(props.language,props.schemeSlug,\"fixed\");}else{errorList=response.data&&response.data.error;if(errorList instanceof Array){errorList.forEach(function(item){toast.error(item);});}console.log(response,\"errrr\");}case 11:case\"end\":return _context.stop();}}},_callee);}));function onSubmit(_x,_x2){return _onSubmit.apply(this,arguments);}return onSubmit;}()}),values=_useFormik.values,errors=_useFormik.errors,touched=_useFormik.touched,handleChange=_useFormik.handleChange,handleBlur=_useFormik.handleBlur,setFieldValue=_useFormik.setFieldValue,handleSubmit=_useFormik.handleSubmit;React.useEffect(function(){if(props.editData){setInitialData(_objectSpread({},props.editData));}},[props.editData]);return/*#__PURE__*/React.createElement(\"form\",{onSubmit:function onSubmit(e){e.preventDefault();handleSubmit();}},/*#__PURE__*/React.createElement(\"div\",{className:\"row align-items-end\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group mt-2\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-1 label pl-0\"},t(\"finance:applyDate\"),/*#__PURE__*/React.createElement(TooltipLabel,{id:\"apd\",text:\"The date from which this record  should be applied to the system.\"})),((_props$scheme=props.scheme)===null||_props$scheme===void 0?void 0:_props$scheme.system_date_format)===\"nep\"?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(NepaliDatePicker,{value:values.apply_date,name:\"apply_date\",onChange:function onChange(e){setFieldValue(\"apply_date\",e);}})):/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(EnglishDatePicker,{name:\"apply_date\",value:values.apply_date,handleChange:function handleChange(e){setFieldValue(\"apply_date\",formatDate(e));}})),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"apply_date\",errors:errors,touched:touched}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group \"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-1 label pl-0\"},t(\"finance:roh\")),/*#__PURE__*/React.createElement(\"input\",{type:\"number\",className:\"form-control\",name:\"rate_for_household\",value:values.rate_for_household,onChange:handleChange}),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"rate_for_household\",errors:errors,touched:touched}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group \"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-1 label pl-0\"},t(\"finance:roi\")),/*#__PURE__*/React.createElement(\"input\",{type:\"number\",className:\"form-control\",name:\"rate_for_institution\",value:values.rate_for_institution,onChange:handleChange}),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"rate_for_institution\",errors:errors,touched:touched}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group \"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-1 label pl-0\"},t(\"finance:rop\")),/*#__PURE__*/React.createElement(\"input\",{type:\"number\",className:\"form-control\",name:\"rate_for_public\",value:values.rate_for_public,onChange:handleChange}),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"rate_for_public\",errors:errors,touched:touched}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group \"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-1 label pl-0\"},t(\"finance:roc\")),/*#__PURE__*/React.createElement(\"input\",{type:\"number\",className:\"form-control\",name:\"rate_for_commercial\",value:values.rate_for_commercial,onChange:handleChange}),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"rate_for_commercial\",errors:errors,touched:touched}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-1 label pl-0\"},t(\"finance:epch\")),/*#__PURE__*/React.createElement(\"input\",{type:\"number\",className:\"form-control\",name:\"estimated_paying_connection_household\",value:values.estimated_paying_connection_household,onChange:handleChange}),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"estimated_paying_connection_household\",errors:errors,touched:touched}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-1 label pl-0\"},t(\"finance:epci\")),/*#__PURE__*/React.createElement(\"input\",{type:\"number\",className:\"form-control\",name:\"estimated_paying_connection_institution\",value:values.estimated_paying_connection_institution,onChange:handleChange}),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"estimated_paying_connection_institution\",errors:errors,touched:touched}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-1 label pl-0\"},t(\"finance:epcp\")),/*#__PURE__*/React.createElement(\"input\",{type:\"number\",className:\"form-control\",name:\"estimated_paying_connection_public\",value:values.estimated_paying_connection_public,onChange:handleChange}),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"estimated_paying_connection_public\",errors:errors,touched:touched}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"\",className:\"mr-1 label pl-0\"},t(\"finance:epcc\")),/*#__PURE__*/React.createElement(\"input\",{type:\"number\",className:\"form-control\",name:\"estimated_paying_connection_commercial\",value:values.estimated_paying_connection_commercial,onChange:handleChange}),/*#__PURE__*/React.createElement(FormikValidationError,{name:\"estimated_paying_connection_commercial\",errors:errors,touched:touched}))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-12 mt-2 text-right\"},/*#__PURE__*/React.createElement(Button,{className:\"btn custom-btn\",text:t(\"home:save\"),type:\"submit\",disabled:props.postLoading||props.updateLoading,loading:props.postLoading||props.updateLoading}))));};var mapStateToProps=function mapStateToProps(state){var _state$waterSchemeDat;return{language:state.i18nextData.languageType,scheme:state.waterSchemeData.waterSchemeDetailsData.data,schemeSlug:(_state$waterSchemeDat=state.waterSchemeData.waterSchemeDetailsData.data)===null||_state$waterSchemeDat===void 0?void 0:_state$waterSchemeDat.slug,postLoading:state.waterTarrifsData.postFixedRateWaterTariff.isFetching,updateLoading:state.waterTarrifsData.updateUseBasedWaterTariff.isFetching};};var mapDispatchToProps={postFixedRateWaterTariffAction:postFixedRateWaterTariffAction,getWaterTarrifsAction:getWaterTarrifsAction,updateFixedRateWaterTariffAction:updateFixedRateWaterTariffAction,getUsIncomeEstimateThisYearAction:getUsIncomeEstimateThisYearAction};var connector=connect(mapStateToProps,mapDispatchToProps);export default connector(UseBasedForm);","map":null,"metadata":{},"sourceType":"module"}